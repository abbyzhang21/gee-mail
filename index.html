<html>
	<head>
		<script src="js/mail-generator.js"></script>
		<link href="css/style.css" rel="stylesheet" media="screen">
		<link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
		<script defer src="https://use.fontawesome.com/releases/v5.0.10/js/all.js" integrity="sha384-slN8GvtUJGnv6ca26v8EzVaR9DC58QEwsIk9q1QXdCU8Yu8ck/tL/5szYlBbqmS+" crossorigin="anonymous"></script>
    <script>
      window.onload = function(){
        // ALL OF YOUR JAVASCRIPT CODE SHOULD GO HERE. 
        // We have to use window.onload so your JavaScript doesn't execute until the page has loaded and all HTML has been downloaded to your browser

  		//setInterval to invoke loadNewMessage, store the new message in geemails, and display it on inbox
  		function loadNewMessage(){
  			var newMessage = getNewMessage();
  		  window.geemails.push(newMessage);
  	    createTable(getNewMessage());
        document.getElementById("inbox").innerHTML = "Inbox " + "(" + geemails.length + ")";
        displayM();
        hiddenBody();
  		}
  		
  		
  		//create row with rds 
  		function createTable(x){
  			var table = document.getElementById("inboxElem");
        var myRow = document.createElement("div");
  			var cell1 = document.createElement("p");
  			var cell2 = document.createElement("p");
  			var cell3 = document.createElement("p");
        var bodyP = document.createElement("div");
        var theFirstChild = table.firstChild;
        myRow.appendChild(cell1);
        myRow.appendChild(cell2);
        myRow.appendChild(cell3);
        myRow.appendChild(bodyP).className = "bodyE";
        table.insertBefore(myRow, theFirstChild);
  			myRow.className = "tableRow";
  			cell1.innerHTML = x.sender;
  			cell2.innerHTML = x.subject;
  			cell3.innerHTML = x.date;
        bodyP.innerHTML = x.body;
  		}
      
  		function createInbox(){
  			for(i = 0; i < geemails.length; i++){
  				createTable(geemails[i]);
  			}
  		}
  		createInbox();

      //hidde body message
      function hiddenBody() {
        var bodyMessage = document.querySelectorAll('.bodyE');
        for(i =0; i<bodyMessage.length; i++){
        bodyMessage[i].style.display = "none";

        }
      }
      hiddenBody();

  		//display message content
      function displayM(){
  		  var showMessage = document.getElementsByClassName("tableRow");
        var bodyElem = getNewMessage().body;
  		  for(i = 0; i < showMessage.length; i++){
  			showMessage[i].addEventListener("click",printMessage);
  		  }
      }
  		  function printMessage(){
  			 var pElem = this.querySelectorAll('.bodyE')[0];
          if(pElem.style.display === 'none'){
            pElem.style.display = 'block';
         }else{
            pElem.style.display = 'none';
         }
  	   	}    
      displayM();
      var pop = setInterval(loadNewMessage, 20000);

  		
      };
      
    </script>
	</head>
	<body>
		<header id="head">Gee-mail</header>
		<div class="container" id="main">
			<button id="inbox"><i class="fas fa-envelope"></i>
Inbox (10)</button>

</button>
			<table id="inboxElem">
			</table>
		</div>
	</body>
</html>